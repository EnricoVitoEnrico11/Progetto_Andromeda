-- nella "grandezza_azienda" conviene un order by
-- adesso procediamo con la creazione della dim_provincia_domicilio

drop table if exists dim_provincia_domicilio;

create table dim_provincia_domicilio as 
 select row_number() over () as ids_provincia_domicilio, * from (
   select distinct pa.provincia_domicilio 
from sondaggio.progetto_andromeda pa
) t

select * from dim_provincia_domicilio

-- adesso procediamo con la "dim_grandezza_azienda"

drop table if exists dim_grandezza_azienda;

create table dim_grandezza_azienda as 
 select row_number() over () as ids_grandezza_azienda, * from (
   select distinct pa.grandezza_azienda 
from sondaggio.progetto_andromeda pa
) t
order by grandezza_azienda; -- ho inserito l'order by perchè c'è una variazione di numeri

-- creazione della "dim_durata_lavoro_in_azienda"

drop table if exists dim_durata_lavoro_in_azienda;

create table dim_durata_lavoro_in_azienda  as 
 select row_number() over () as ids_durata_lavoro_in_azienda, * from (
   select distinct pa.durata_lavoro_in_azienda 
from sondaggio.progetto_andromeda pa

) t 
order by durata_lavoro_in_azienda;

-- creazione dim_provincia_ultimo_lavoro

drop table if exists dim_provincia_ultimo_lavoro;

create table dim_provincia_ultimo_lavoro  as 
 select row_number() over () as ids_provincia_ultimo_lavoro, * from (
   select distinct pa.provincia_ultimo_lavoro
from sondaggio.progetto_andromeda pa

) t 
order by provincia_ultimo_lavoro;

-- creazione dim_vittima_o_testimone_in_azienda

drop table if exists dim_vittima_o_testimone_di_discriminazione_in_azienda;